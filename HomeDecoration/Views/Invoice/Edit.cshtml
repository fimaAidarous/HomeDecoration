@model HomeDecoration.Models.DTO.Invoice
List<

<h2>Edit Invoice</h2>

<form asp-action="Edit">
    <div class="form-group">
        <label asp-for="Payment_Status" class="control-label">Payment Status</label>
        <select asp-for="Payment_Status" class="form-control">
            <option value="Paid">Paid</option>
        </select>
    </div>

    <input type="submit" value="Pay" class="btn btn-info" id="payButton" />
</form>

<script>
    $(function () {
        $("#payButton").click(function (e) {
            e.preventDefault();
            var form = $(this).closest("form");
            var url = form.attr("action");

            var orderDropdown = form.find("select[name='OrderId']");
            var orderId = orderDropdown.val();
            var paymentStatus = orderDropdown.data("payment-status");

            // Update payment status only if it is not already "Paid"
            if (paymentStatus !== "Paid") {
                form.find("select[name='Payment_Status']").val("Paid");
            }

            $.ajax({
                type: "POST",
                url: url,
                data: {
                    Id: orderId,
                    Payment_Status: "Paid"
                },
                success: function (data) {
                    alert("Payment successfully made.");
                    location.reload();
                },
                error: function () {
                    alert("An error occurred while processing the payment.");
                }
            });
        });
    });
</script>